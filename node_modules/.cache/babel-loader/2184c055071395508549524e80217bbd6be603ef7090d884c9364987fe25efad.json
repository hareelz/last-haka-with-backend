{"ast":null,"code":"import { createAsyncThunk } from \"@reduxjs/toolkit\";\nimport axios from \"axios\";\nimport { API } from \"../../helpers/consts\";\nexport const register = createAsyncThunk(\"auth/register\", async newUser => {\n  try {\n    await axios.post(`${API}/v1/customer/register/`, newUser);\n  } catch (error) {\n    throw error;\n  }\n});\nexport const login = createAsyncThunk(\"auth/login\", async userData => {\n  try {\n    const result = await axios.post(`${API}/v1/customer/login/`, userData);\n    localStorage.setItem(\"tokens\", JSON.stringify(result.data));\n    localStorage.setItem(\"email\", userData.email);\n    console.log(result);\n    return userData.email;\n  } catch (error) {\n    throw error;\n  }\n});\nexport const logout = () => {\n  localStorage.removeItem(\"tokens\");\n  localStorage.removeItem(\"email\");\n};\nexport const checkAuth = createAsyncThunk(\"auth/checkAuth\", async () => {\n  try {\n    const tokens = JSON.parse(localStorage.getItem(\"tokens\"));\n    const Authorization = `Bearer ${tokens.access}`;\n    const config = {\n      headers: {\n        Authorization\n      }\n    };\n    const result = await axios.post(`${API}/v1/customer/refresh/`, {\n      refresh: tokens.refresh\n    }, config);\n    localStorage.setItem(\"tokens\", JSON.stringify({\n      access: result.data.access,\n      refresh: tokens.refresh\n    }));\n  } catch (error) {\n    logout();\n  }\n});","map":{"version":3,"names":["createAsyncThunk","axios","API","register","newUser","post","error","login","userData","result","localStorage","setItem","JSON","stringify","data","email","console","log","logout","removeItem","checkAuth","tokens","parse","getItem","Authorization","access","config","headers","refresh"],"sources":["C:/Users/Dzhum/OneDrive/Рабочий стол/last-haka-with-backend/src/store/actions/authActions.js"],"sourcesContent":["import { createAsyncThunk } from \"@reduxjs/toolkit\";\r\nimport axios from \"axios\";\r\nimport { API } from \"../../helpers/consts\";\r\n\r\nexport const register = createAsyncThunk(\"auth/register\", async (newUser) => {\r\n  try {\r\n    await axios.post(`${API}/v1/customer/register/`, newUser);\r\n  } catch (error) {\r\n    throw error;\r\n  }\r\n});\r\n\r\nexport const login = createAsyncThunk(\"auth/login\", async (userData) => {\r\n  try {\r\n    const result = await axios.post(`${API}/v1/customer/login/`, userData);\r\n    localStorage.setItem(\"tokens\", JSON.stringify(result.data));\r\n    localStorage.setItem(\"email\", userData.email);\r\n    console.log(result);\r\n    return userData.email;\r\n  } catch (error) {\r\n    throw error;\r\n  }\r\n});\r\n\r\nexport const logout = () => {\r\n  localStorage.removeItem(\"tokens\");\r\n  localStorage.removeItem(\"email\");\r\n};\r\n\r\nexport const checkAuth = createAsyncThunk(\"auth/checkAuth\", async () => {\r\n  try {\r\n    const tokens = JSON.parse(localStorage.getItem(\"tokens\"));\r\n\r\n    const Authorization = `Bearer ${tokens.access}`;\r\n\r\n    const config = {\r\n      headers: {\r\n        Authorization,\r\n      },\r\n    };\r\n\r\n    const result = await axios.post(\r\n      `${API}/v1/customer/refresh/`,\r\n      {\r\n        refresh: tokens.refresh,\r\n      },\r\n      config\r\n    );\r\n\r\n    localStorage.setItem(\r\n      \"tokens\",\r\n      JSON.stringify({\r\n        access: result.data.access,\r\n        refresh: tokens.refresh,\r\n      })\r\n    );\r\n  } catch (error) {\r\n    logout();\r\n  }\r\n});\r\n"],"mappings":"AAAA,SAASA,gBAAgB,QAAQ,kBAAkB;AACnD,OAAOC,KAAK,MAAM,OAAO;AACzB,SAASC,GAAG,QAAQ,sBAAsB;AAE1C,OAAO,MAAMC,QAAQ,GAAGH,gBAAgB,CAAC,eAAe,EAAE,MAAOI,OAAO,IAAK;EAC3E,IAAI;IACF,MAAMH,KAAK,CAACI,IAAI,CAAE,GAAEH,GAAI,wBAAuB,EAAEE,OAAO,CAAC;EAC3D,CAAC,CAAC,OAAOE,KAAK,EAAE;IACd,MAAMA,KAAK;EACb;AACF,CAAC,CAAC;AAEF,OAAO,MAAMC,KAAK,GAAGP,gBAAgB,CAAC,YAAY,EAAE,MAAOQ,QAAQ,IAAK;EACtE,IAAI;IACF,MAAMC,MAAM,GAAG,MAAMR,KAAK,CAACI,IAAI,CAAE,GAAEH,GAAI,qBAAoB,EAAEM,QAAQ,CAAC;IACtEE,YAAY,CAACC,OAAO,CAAC,QAAQ,EAAEC,IAAI,CAACC,SAAS,CAACJ,MAAM,CAACK,IAAI,CAAC,CAAC;IAC3DJ,YAAY,CAACC,OAAO,CAAC,OAAO,EAAEH,QAAQ,CAACO,KAAK,CAAC;IAC7CC,OAAO,CAACC,GAAG,CAACR,MAAM,CAAC;IACnB,OAAOD,QAAQ,CAACO,KAAK;EACvB,CAAC,CAAC,OAAOT,KAAK,EAAE;IACd,MAAMA,KAAK;EACb;AACF,CAAC,CAAC;AAEF,OAAO,MAAMY,MAAM,GAAGA,CAAA,KAAM;EAC1BR,YAAY,CAACS,UAAU,CAAC,QAAQ,CAAC;EACjCT,YAAY,CAACS,UAAU,CAAC,OAAO,CAAC;AAClC,CAAC;AAED,OAAO,MAAMC,SAAS,GAAGpB,gBAAgB,CAAC,gBAAgB,EAAE,YAAY;EACtE,IAAI;IACF,MAAMqB,MAAM,GAAGT,IAAI,CAACU,KAAK,CAACZ,YAAY,CAACa,OAAO,CAAC,QAAQ,CAAC,CAAC;IAEzD,MAAMC,aAAa,GAAI,UAASH,MAAM,CAACI,MAAO,EAAC;IAE/C,MAAMC,MAAM,GAAG;MACbC,OAAO,EAAE;QACPH;MACF;IACF,CAAC;IAED,MAAMf,MAAM,GAAG,MAAMR,KAAK,CAACI,IAAI,CAC5B,GAAEH,GAAI,uBAAsB,EAC7B;MACE0B,OAAO,EAAEP,MAAM,CAACO;IAClB,CAAC,EACDF,MACF,CAAC;IAEDhB,YAAY,CAACC,OAAO,CAClB,QAAQ,EACRC,IAAI,CAACC,SAAS,CAAC;MACbY,MAAM,EAAEhB,MAAM,CAACK,IAAI,CAACW,MAAM;MAC1BG,OAAO,EAAEP,MAAM,CAACO;IAClB,CAAC,CACH,CAAC;EACH,CAAC,CAAC,OAAOtB,KAAK,EAAE;IACdY,MAAM,CAAC,CAAC;EACV;AACF,CAAC,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}